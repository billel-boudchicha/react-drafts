<!DOCTYPE html>
<html lang="{{ site.lang | default: "en-US" }}">
  <head>
    <meta charset="UTF-8">

{% seo %}
    <meta name="description" content="{{ page.description | default: site.description | default: site.github.project_tagline }}"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="{{ '/assets/css/style.css?v=' | append: site.github.build_revision | relative_url }}">
    <link rel="stylesheet" href="https://unpkg.com/react-drafts@1.0.2/dist/react-drafts.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/es6-shim/0.35.3/es6-shim.min.js" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.23.1/babel.js" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.4.2/react.min.js" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.4.2/react-dom.min.js" type="text/javascript"></script>
    <style>
      .drafts-editor {
        background-color: white;
        border-radius: 5px;
        margin: 30px auto 40px;
        overflow: hidden;
      }

      .drafts-editor,
      .drafts-editor__toolbar,
      .drafts-editor__toolbar .controls,
      .drafts-editor__toolbar.detached .controls {
        min-width: 760px;
      }

      .drafts-editor__external-controls {
        width: 100%;
        display: block;
      }

      .drafts-editor__external-control {
        width: 95px;
        line-height: 2.4em;
        margin-right: 6px;
      }

      .drafts-editor__toolbar .drafts-editor__menu button,
      .drafts-editor__toolbar .btn {
        color: #777;
      }

      .demo-title-msg {
        font-weight: bold;
        letter-spacing: 1px;
      }

      .save-msg {
        position: absolute;
        top: 16px;
        right: 10%;
        color: #bebebe;
      }
    </style>
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">react-drafts</h1>
      <h2 class="project-tagline">React-based WYSIWYG editor built using DraftJS. Supports the most commonly requested editor features, plus some uncommonly found features like tables.</h2>
      {% if site.github.is_project_page %}
        <a href="{{ site.github.repository_url }}" class="btn">View on GitHub</a>
      {% endif %}
      <div id="app"></div>
    </section>

    <section class="main-content">

      {{ content }}

      <footer class="site-footer">
        {% if site.github.is_project_page %}
          <span class="site-footer-owner"><a href="{{ site.github.repository_url }}">{{ site.github.repository_name }}</a> is maintained by <a href="{{ site.github.owner_url }}">{{ site.github.owner_name }}</a>.</span>
        {% endif %}
        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</span>
      </footer>
    </section>

    <script src="https://unpkg.com/react-drafts@1.0.2/dist/react-drafts.js"" type="text/javascript"></script>
    <script type="text/babel">
      class DemoEditor extends React.Component {
        constructor() {
          super();

          this.state = {
            isSaving: false,
            lastSavedAt: null
          };

          this.handleLoadSavedContent = this.handleLoadSavedContent.bind(this);
          this.handleFileUpload = this.handleFileUpload.bind(this);
          this.handleSave = this.handleSave.bind(this);
          this.handleClear = this.handleClear.bind(this);
        }

        handleLoadSavedContent() {
          const saved = localStorage.getItem('myContent');
          return saved || '';
        }

        handleFileUpload(file) {
          return Promise.resolve({
            src: file.preview,
            name: file.name
          });
        }

        handleSave() {
          this.setState({
            isSaving: true
          }, () => {
            this.editor.save().then(content => {
              localStorage.setItem('myContent', content);

              const date = new Date();
              setTimeout(() => {
                this.setState({
                  isSaving: false,
                  lastSavedAt: date.toLocaleString()
                });
              }, 1000);
            });
          });
        }

        handleClear() {
          localStorage.removeItem('myContent');
          this.editor.clear();
        }

        render() {
          const { isSaving, lastSavedAt } = this.state;
          const storedContent = this.handleLoadSavedContent();

          return (
            <div className="demo-editor">
              <p className="save-msg">
                {lastSavedAt && `Last saved: ${lastSavedAt || ''}`}
              </p>
              <div className="drafts-editor__external-controls">
                <p className="demo-title-msg">Demo: saves html content to localStorage</p>
                <button className="drafts-editor__external-control clear" onClick={this.handleClear}>Clear</button>
                <button className="drafts-editor__external-control save" onClick={this.handleSave}>
                  { isSaving ? 'Saving' : 'Save' }
                </button>
              </div>
              <ReactDrafts
                ref={editor => this.editor = editor}
                content={storedContent}
                onFileUpload={this.handleFileUpload}
                allowPhotoLink={true}
                allowPhotoSizeAdjust={true}
                maxImgWidth={960}
                detachToolbarOnScroll={false}
                linkInputAcceptsFiles={true}
                exportTo="html"
              />
            </div>
          );
        }
      }

      ReactDOM.render(
        <DemoEditor />,
        document.getElementById('app')
      );
    </script>

    {% if site.google_analytics %}
      <script type="text/javascript">
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', '{{ site.google_analytics }}', 'auto');
        ga('send', 'pageview');
      </script>
    {% endif %}
  </body>
</html>
